# Audiobookshelf Environment Configuration
# Copy this file to .env and adjust the values as needed
#
# üìñ Official Documentation: https://www.audiobookshelf.org/docs
# üê≥ Docker Hub: https://hub.docker.com/r/mildman1848/audiobookshelf
# üìÇ GitHub: https://github.com/mildman1848/audiobookshelf

# ==============================================================================
# LINUXSERVER.IO BASE CONFIGURATION
# üìñ User Guide: https://docs.linuxserver.io/FAQ
# ==============================================================================

# Container User/Group IDs (should match your host user for proper permissions)
PUID=1000
PGID=1000

# Timezone setting
TZ=Europe/Berlin

# UMASK for file creation (LinuxServer.io standard)
# Default: 022 (files: 644, directories: 755)
UMASK=022

# LinuxServer.io Branding (required for non-first-party containers)
LSIO_FIRST_PARTY=false

# Docker Mods Support (LinuxServer.io)
# üìñ Mods: https://mods.linuxserver.io/
# Example: DOCKER_MODS=linuxserver/mods:universal-cron|linuxserver/mods:audiobookshelf-flac2mp3
# DOCKER_MODS=

# Custom Scripts and Services Paths (LinuxServer.io)
# HOST_CUSTOM_SCRIPTS=./custom-scripts
# HOST_CUSTOM_SERVICES=./custom-services

# Docker image settings
AUDIOBOOKSHELF_VERSION=v2.29.0
DOCKER_REPO=mildman1848/audiobookshelf
VERSION=latest

# Container Names
CONTAINER_NAME=audiobookshelf
CONTAINER_NAME_DB=audiobookshelf-db
POSTGRES_CONTAINER_NAME=audiobookshelf-postgres

# ==============================================================================
# AUDIOBOOKSHELF CORE CONFIGURATION
# üìñ Network: https://www.audiobookshelf.org/docs#network
# üìñ Filesystem: https://www.audiobookshelf.org/docs#filesystem
# ==============================================================================

# Network Configuration
# üìñ See: https://www.audiobookshelf.org/docs#network
HOST=0.0.0.0
PORT=80
EXTERNAL_PORT=13378

# Host binding for security (127.0.0.1 = localhost only, 0.0.0.0 = all interfaces)
# CRITICAL: Use 127.0.0.1 for production to prevent external access
HOST_BIND=127.0.0.1

# Path Configuration (Container paths - do not change unless you know what you're doing)
# üìñ See: https://www.audiobookshelf.org/docs#filesystem
CONFIG_PATH=/config
METADATA_PATH=/metadata
BACKUP_PATH=/config/backups

# Host Volume Paths (adjust these to your local directories)
HOST_CONFIG_PATH=./config
HOST_AUDIOBOOKS_PATH=./data/audiobooks
HOST_PODCASTS_PATH=./data/podcasts
HOST_METADATA_PATH=./data/metadata
HOST_CONFIG_PATH_DB=./config-db

# Database Volume Path
POSTGRES_DATA_PATH=./postgres_data

# ==============================================================================
# BINARY PATHS
# üìñ External Tools: https://www.audiobookshelf.org/docs#external-tools
# ==============================================================================

# FFmpeg Configuration (using Alpine package paths)
# üìñ See: https://www.audiobookshelf.org/docs#external-tools
FFMPEG_PATH=/usr/bin/ffmpeg
FFPROBE_PATH=/usr/bin/ffprobe

# ==============================================================================
# SECURITY CONFIGURATION
# üìñ Security: https://www.audiobookshelf.org/docs#security
# ==============================================================================

# JWT Secret (will be auto-generated if not set)
# Use a strong random string - can be generated with: openssl rand -base64 32
# üìñ See: https://www.audiobookshelf.org/docs#security
# JWT_SECRET=your-super-secure-jwt-secret-here

# CORS Configuration
# üìñ See: https://www.audiobookshelf.org/docs#security
CORS_ENABLED=0

# Security Features
# üìñ See: https://www.audiobookshelf.org/docs#security
DISABLE_SSRF=0
ALLOW_IFRAMES=0

# ==============================================================================
# APPLICATION SETTINGS
# üìñ Other Configuration: https://www.audiobookshelf.org/docs#other
# ==============================================================================

# Installation Source
# üìñ See: https://www.audiobookshelf.org/docs#other
SOURCE=docker

# Log Level (debug, info, warn, error)
LOG_LEVEL=info

# Session Configuration
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTP_ONLY=true

# ==============================================================================
# ADVANCED CONFIGURATION
# ==============================================================================

# External Ports
EXTERNAL_PORT_DB=13379

# Database Configuration (if using external database)
# üìñ See: https://www.audiobookshelf.org/docs#installation for database setup
DB_TYPE=postgres
DB_HOST=postgres
DB_PORT=5432
DB_NAME=audiobookshelf
POSTGRES_VERSION=15

# Backup Configuration
# üìñ See: https://www.audiobookshelf.org/docs#filesystem
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_KEEP_COUNT=7
BACKUP_SIZE_LIMIT=1000000000  # 1GB in bytes

# Performance Tuning
MAX_CONCURRENT_SCANS=1
SCANNER_DISABLE_WATCHER=false

# ==============================================================================
# SECRETS CONFIGURATION
# üìñ LinuxServer.io FILE__ Secrets: https://docs.linuxserver.io/FAQ
# ==============================================================================

# LinuxServer.io FILE__ Prefix Secrets (recommended)
# These read values from files - more secure than environment variables
# These are set directly in docker-compose.yml to point to Docker secrets
# FILE__JWT_SECRET=/run/secrets/audiobookshelf_jwt_secret
# FILE__API_KEY=/run/secrets/audiobookshelf_api_key
# FILE__DB_USER=/run/secrets/audiobookshelf_db_user
# FILE__DB_PASSWORD=/run/secrets/audiobookshelf_db_password

# Secrets Path for file-based secrets
SECRETS_PATH=./secrets

# Docker Secrets Support (legacy/backwards compatibility)
USE_DOCKER_SECRETS=false

# Legacy secret file names (used with Docker Swarm secrets)
JWT_SECRET_FILE=audiobookshelf_jwt_secret
API_KEY_SECRET_FILE=audiobookshelf_api_key
DB_PASSWORD_SECRET_FILE=audiobookshelf_db_password
DB_USER_SECRET_FILE=audiobookshelf_db_user

# ==============================================================================
# DEVELOPMENT/DEBUG
# ==============================================================================

# Development Mode
NODE_ENV=production

# Debug Configuration
DEBUG_MODE=false
VERBOSE_LOGGING=false

# ==============================================================================
# NETWORKING
# ==============================================================================

# Reverse Proxy Configuration
TRUST_PROXY=false
BEHIND_PROXY=false

# Custom Headers
CUSTOM_HEADERS_ENABLED=false

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================

# Experimental Features
ENABLE_EXPERIMENTAL_FEATURES=false

# Scanner Configuration
ENABLE_FILE_WATCHER=true
SCANNER_FIND_COVERS=true

# Podcast Features
PODCAST_EPISODE_AUTO_DOWNLOAD=false

# ==============================================================================
# NETWORKING
# ==============================================================================

# Network Configuration
NETWORK_NAME=audiobookshelf_network
NETWORK_SUBNET=172.20.0.0/16

# Reverse Proxy Configuration
TRUST_PROXY=false
BEHIND_PROXY=false

# Custom Headers
CUSTOM_HEADERS_ENABLED=false

# ==============================================================================
# MONITORING & HEALTH CHECKS
# ==============================================================================

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3

# Metrics Configuration
ENABLE_METRICS=false
METRICS_PORT=9090